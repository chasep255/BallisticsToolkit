<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>F-Class Simulator - Interactive Long-Range Shooting | Ballistics Toolkit</title>
  <meta name="description" content="Interactive F-Class shooting simulator with realistic ballistics including spin effects, wind reading (mirage and flags), 3D visualization, and authentic match scoring. Practice long-range precision shooting at standard F-Class distances (300-1000 yards) with correct targets and scoring.">
  <meta name="keywords" content="F-Class simulator, shooting simulator, long range shooting, 3D shooting game, ballistics simulation, wind reading, mirage effect, spin drift, crosswind jump, match scoring">
  <link rel="canonical" href="https://www.ballisticstoolkit.com/fclass-sim/fclass-sim.html">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://www.ballisticstoolkit.com/fclass-sim/fclass-sim.html">
  <meta property="og:title" content="F-Class Simulator - Interactive Long-Range Shooting">
  <meta property="og:description" content="Interactive F-Class shooting simulator with realistic ballistics including spin effects, wind reading (mirage and flags), 3D visualization, and authentic match scoring. Practice long-range precision shooting at standard F-Class distances (300-1000 yards).">
  <meta property="og:image" content="https://www.ballisticstoolkit.com/ballistics-toolkit-logo.png">
  
  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://www.ballisticstoolkit.com/fclass-sim/fclass-sim.html">
  <meta property="twitter:title" content="F-Class Simulator - Interactive Long-Range Shooting">
  <meta property="twitter:description" content="Interactive F-Class shooting simulator with realistic ballistics including spin effects, wind reading (mirage and flags), 3D visualization, and authentic match scoring. Practice long-range precision shooting at standard F-Class distances (300-1000 yards).">
  <meta property="twitter:image" content="https://www.ballisticstoolkit.com/ballistics-toolkit-logo.png">
  
  <link rel="icon" type="image/x-icon" href="../ballistics-toolkit-favicon.ico">
  <link rel="stylesheet" href="../common.css">
  <link rel="stylesheet" href="fclass-sim.css">
  
  <!-- Schema.org structured data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "VideoGame",
    "name": "F-Class Simulator",
    "description": "Interactive F-Class shooting simulator with realistic ballistics including spin effects, wind reading, 3D visualization, and authentic match scoring",
    "url": "https://www.ballisticstoolkit.com/fclass-sim/fclass-sim.html",
    "applicationCategory": "Game",
    "operatingSystem": "Web Browser",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    },
    "gamePlatform": "Web Browser"
  }
  </script>
  
  <script src="../common.js"></script>
  <script type="importmap">
    {
      "imports": {
        "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
        "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
      }
    }
  </script>
  <script type="module" src="simulator.js"></script>
</head>
<body data-page="fclass-sim">
  <div class="nav-header"></div>

  <div class="app-container">
        <h1>üéÆ F-Class Simulator</h1>

    <!-- Game Settings & Accuracy -->
    <div class="params-bar">
      <div class="param-item">
        <label for="fclassMode" title="Target distance and type">Range</label>
        <select id="fclassMode" title="Target distance and type">
          <option value="fclass-300">300 yards</option>
          <option value="fclass-500">500 yards</option>
          <option value="fclass-600">600 yards</option>
          <option value="fclass-800">800 yards</option>
          <option value="fclass-900">900 yards</option>
          <option value="fclass-1000" selected>1000 yards</option>
        </select>
      </div>
      <div class="param-item">
        <label for="windPreset" title="Wind conditions">Wind</label>
        <select id="windPreset" title="Wind conditions">
          <!-- Options will be populated dynamically from C++ -->
        </select>
      </div>
      <div class="param-item">
        <label for="focalPlane" title="Reticle focal plane: SFP stays fixed size, FFP scales with zoom">Reticle</label>
        <select id="focalPlane" title="Reticle focal plane: SFP stays fixed size, FFP scales with zoom">
          <option value="SFP" selected>SFP (Fixed)</option>
          <option value="FFP">FFP (Scaling)</option>
        </select>
      </div>
      <div class="param-item">
        <label for="mvSd" title="Muzzle velocity variation in fps - typical values: 5-15 fps">MV œÉ (fps)</label>
        <input type="number" id="mvSd" value="7.0" step="0.5" min="0" max="50" title="Muzzle velocity variation in fps - typical values: 5-15 fps">
      </div>
      <div class="param-item">
        <label for="rifleAccuracy" title="Rifle accuracy in MOA (1 MOA ‚âà 1 inch at 100 yards)">Accuracy (MOA)</label>
        <input type="number" id="rifleAccuracy" value="0.25" step="0.05" min="0" max="5" title="Rifle accuracy in MOA (1 MOA ‚âà 1 inch at 100 yards)">
      </div>
    </div>

    <!-- Ballistics Settings -->
    <div class="params-bar">
      <div class="param-item">
        <label for="bc" title="Ballistic Coefficient (0.001-1.0) - higher values mean better aerodynamics">BC</label>
        <input type="number" id="bc" value="0.311" step="0.001" min="0.001" max="1.0" title="Ballistic Coefficient (0.001-1.0) - higher values mean better aerodynamics">
      </div>
      <div class="param-item">
        <label for="dragFunction" title="G7 is recommended for modern bullets, G1 for older data">Drag</label>
        <select id="dragFunction" title="G7 is recommended for modern bullets, G1 for older data">
          <option value="G1">G1</option>
          <option value="G7" selected>G7</option>
        </select>
      </div>
      <div class="param-item">
        <label for="mv" title="Muzzle velocity in feet per second">MV (fps)</label>
        <input type="number" id="mv" value="2750" step="10" min="1000" max="5000" title="Muzzle velocity in feet per second">
      </div>
      <div class="param-item">
        <label for="diameter" title="Bullet diameter in inches (e.g., 0.264 for 6.5mm)">Dia (in)</label>
        <input type="number" id="diameter" value="0.264" step="0.001" min="0.1" max="1.0" title="Bullet diameter in inches (e.g., 0.264 for 6.5mm)">
      </div>
      <div class="param-item">
        <label for="weight" title="Bullet weight in grains (e.g., 140 for 6.5mm)">Wt (gr)</label>
        <input type="number" id="weight" value="140" step="1" min="10" max="1000" title="Bullet weight in grains (e.g., 140 for 6.5mm)">
      </div>
      <div class="param-item">
        <label for="length" title="Bullet length in inches (e.g., 1.4 for 6.5mm)">Len (in)</label>
        <input type="number" id="length" value="1.4" step="0.01" min="0.1" max="5.0" title="Bullet length in inches (e.g., 1.4 for 6.5mm)">
      </div>
      <div class="param-item">
        <label for="twist" title="Barrel twist rate in inches per turn (e.g., 8 for 1:8 twist)">Twist (in/turn)</label>
        <input type="number" id="twist" value="8.0" step="0.1" min="1" max="20" title="Barrel twist rate in inches per turn (e.g., 8 for 1:8 twist)">
      </div>
      <div class="param-item" style="display: flex; align-items: center; gap: 8px;">
        <input type="checkbox" id="enableSpinEffects" checked style="width: auto; margin: 0;">
        <label for="enableSpinEffects" style="margin: 0; font-weight: normal;" title="Enable spin drift and crosswind jump effects. Uncheck to disable experimental spin effects.">Enable Spin Effects</label>
      </div>
    </div>

    <!-- Control Buttons -->
    <div style="display: flex; align-items: center; gap: 10px; justify-content: center; margin: 15px 0;">
      <button id="startBtn" class="btn btn-primary">Start Game</button>
      <button id="pauseBtn" class="btn btn-secondary" style="display: none;">Pause</button>
      <button id="restartBtn" class="btn btn-secondary" style="display: none;">Restart</button>
      <button id="scorecardBtn" class="btn btn-secondary" style="display: none;">Scorecard</button>
      <button id="goForRecordBtn" class="btn btn-secondary" style="display: none;">Go For Record</button>
      <button id="windHUDBtn" class="btn btn-secondary" style="display: none;">Wind HUD</button>
      <button id="helpBtn" class="btn btn-secondary">Help</button>
    </div>

    <div id="error" class="error" style="display: none;"></div>
    
    <div class="canvas-wrap">
      <canvas id="gameCanvas" width="800" height="600"></canvas>
      
      <!-- Quick Key Guide -->
      <div class="quick-keys">
        <div class="quick-keys-section">
          <strong>Spotting Scope:</strong><br>
          <kbd>W</kbd><kbd>A</kbd><kbd>S</kbd><kbd>D</kbd> Pan ‚Ä¢ <kbd>E</kbd><kbd>Q</kbd> Zoom
        </div>
        <div class="quick-keys-section">
          <strong>Rifle Scope:</strong><br>
          <kbd>‚Üë</kbd><kbd>‚Üì</kbd><kbd>‚Üê</kbd><kbd>‚Üí</kbd> Aim<br>
          <kbd>Shift</kbd>+<kbd>‚Üë</kbd><kbd>‚Üì</kbd><kbd>‚Üê</kbd><kbd>‚Üí</kbd> Dial<br>
          <kbd>+</kbd><kbd>-</kbd> Zoom ‚Ä¢ <kbd>R</kbd> Reset
        </div>
        <div class="quick-keys-section">
          <strong>Fire:</strong> <kbd>Space</kbd>
        </div>
      </div>
    </div>
  </div>

  <!-- Help Modal -->
  <div id="helpModal" class="help-modal" style="display: none;">
    <div class="help-modal-content">
      <div class="help-modal-header">
                <h2>F-Class Simulator Help</h2>
        <span class="help-close">&times;</span>
      </div>
      <div class="help-modal-body">
        <div class="help-section" style="padding: 15px 0; border-bottom: 2px solid #ddd; margin-bottom: 20px;">
          <h3 style="margin-top: 0;">Need Help or Found an Issue?</h3>
          <div class="param-help">
            <strong>üìß Email:</strong> <a href="mailto:admin@ballisticstoolkit.com">admin@ballisticstoolkit.com</a><br>
            <strong>üíª GitHub:</strong> <a href="https://github.com/chasep255/BallisticsToolkit" target="_blank" rel="noopener noreferrer">github.com/chasep255/BallisticsToolkit</a>
          </div>
        </div>
        
        <div class="help-section">
          <h3>Overview</h3>
          <p>F-Class Simulator is an interactive 3D shooting simulator that recreates the experience of long-range F-Class competition shooting. Practice reading wind (mirage and flags), managing ballistics with spin effects, and making precise shots at standard F-Class distances from 300 to 1000 yards with correct targets and authentic match scoring.</p>
        </div>
        
        <div class="help-section">
          <h3>Controls</h3>
          <div class="param-help">
            <strong>Spotting Scope (Bottom-Left):</strong><br>
            - <kbd>W</kbd><kbd>A</kbd><kbd>S</kbd><kbd>D</kbd> Pan camera<br>
            - <kbd>E</kbd>/<kbd>Q</kbd> Zoom in/out<br>
            - Movement scales with FOV (slower when zoomed in)<br>
            - Use to read mirage, flags, and observe shot impacts<br><br>

            <strong>Rifle Scope (Bottom-Right):</strong><br>
            - <kbd>‚Üë</kbd><kbd>‚Üì</kbd><kbd>‚Üê</kbd><kbd>‚Üí</kbd> Aim (holdover)<br>
            - <kbd>Shift</kbd>+<kbd>‚Üë</kbd><kbd>‚Üì</kbd><kbd>‚Üê</kbd><kbd>‚Üí</kbd> Dial adjustments (1/8 MOA clicks, ¬±10 MOA limit)<br>
            - <kbd>+</kbd>/<kbd>-</kbd> Zoom in/out<br>
            - <kbd>R</kbd> Reset (zero dial, initial zoom, center on target)<br>
            - Dial position shown in lower right (elevation/windage in MOA)<br>
            - SFP: reticle fixed size, hash marks accurate at initial zoom only<br>
            - FFP: reticle scales with zoom, hash marks always accurate<br><br>

            <strong>Firing:</strong><br>
            - <kbd>Space</kbd> Fire shot (disabled while target is down)
          </div>
        </div>
        
        <div class="help-section">
          <h3>Buttons</h3>
          <div class="param-help">
            - <strong>Start:</strong> Begin the match<br>
            - <strong>Pause/Resume:</strong> Pause/resume match timer and audio<br>
            - <strong>Restart:</strong> Restart match (with confirmation)<br>
            - <strong>Scorecard:</strong> View detailed per-relay scores and parameters<br>
            - <strong>Go For Record:</strong> End sighters phase early in current relay<br>
            - <strong>Wind HUD:</strong> Toggle wind field visualization on/off
          </div>
        </div>
        
        <div class="help-section">
          <h3>Wind Reading</h3>
          <div class="param-help">
            <strong>Wind Flags:</strong><br>
            - Read flag angle and flap intensity<br>
            - Watch multiple distances for wind shear and gradients<br><br>

            <strong>Mirage:</strong><br>
            - Zoom in with spotting scope to read heat shimmer<br>
            - Light wind: vertical boil<br>
            - Moderate wind: leaning shimmer<br>
            - Strong wind: mostly horizontal flow<br>
            - Mirage samples wind over final 25% of distance to aim point<br><br>

            <strong>Wind HUD (Optional):</strong><br>
            - Toggle on/off with button during match<br>
            - Vertical strip at top-left showing downrange wind progression<br>
            - Bottom = shooter position (0 yards), Top = target position<br>
            - Color-coded: blue (calm) ‚Üí red (strong, 7.5+ mph)<br>
            - White arrows show wind direction<br>
            - Samples 25 downrange positions √ó 10 crossrange positions<br>
            - Updates in real-time as wind changes
          </div>
        </div>
        
        <div class="help-section">
          <h3>Match Structure</h3>
          <div class="param-help">
            <strong>Format:</strong><br>
            - 3 relays, 20 minutes each<br>
            - 20 record shots per relay (60 total)<br>
            - Relay 1: unlimited sighters<br>
            - Relays 2-3: 2 sighters each<br><br>
            
            <strong>Flow:</strong><br>
            - Use "Go For Record" button to end sighters phase early<br>
            - Relay ends at 20 record shots OR time expires<br>
            - Acknowledge relay-complete dialog to proceed to next relay<br>
            - Rifle disabled while target is down (changing/marking)<br>
          </div>
        </div>
        
        <div class="help-section">
          <h3>Ballistic Parameters</h3>
          <div class="param-help">
            <strong>Bullet:</strong><br>
            - <strong>BC:</strong> Ballistic coefficient (aerodynamic efficiency, higher = less drift/drop)<br>
            - <strong>Drag Function:</strong> G7 (modern boat-tail) or G1 (flat-base/older)<br>
            - <strong>Diameter:</strong> Caliber in inches (affects scoring and spin)<br>
            - <strong>Weight:</strong> Bullet weight in grains (for spin moment of inertia)<br>
            - <strong>Length:</strong> Bullet length in inches (for spin calculations)<br><br>

            <strong>Rifle:</strong><br>
            - <strong>MV:</strong> Muzzle velocity in fps (critical for trajectory/time-of-flight)<br>
            - <strong>MV œÉ:</strong> Velocity standard deviation in fps (lower = more consistent)<br>
            - <strong>Accuracy:</strong> Rifle+shooter precision in MOA (1 MOA ‚âà 1" at 100 yards)<br>
            - <strong>Twist:</strong> Barrel twist rate (e.g., 8 for 1:8 twist, calculates spin rate)<br>
            - <strong>Reticle:</strong> SFP (fixed size) or FFP (scales with zoom)<br><br>

            <strong>Spin Effects (When Enabled):</strong><br>
            - Spin drift is zeroed during setup<br>
            - Crosswind jump simulated when wind changes<br>
            - Brief trajectory jump before bullet stabilizes
          </div>
        </div>
        
        <div class="help-section">
          <h3>HUD Display (Top-Right)</h3>
          <div class="param-help">
            - <strong>Relay:</strong> Current relay (1/3, 2/3, 3/3)<br>
            - <strong>Timer:</strong> Remaining time (minutes:seconds)<br>
            - <strong>Target:</strong> Your target number<br>
            - <strong>Sighters:</strong> Count N/‚àû (Relay 1) or N/2 (Relays 2-3), only shown during sighters<br>
            - <strong>Shots:</strong> Record shots N/20 (turns green at 20/20)<br>
            - <strong>Score:</strong> Total score and X-count for current relay<br>
            - <strong>Dropped:</strong> Points and X-count dropped in current relay<br>
            - <strong>Last Shot:</strong> Score value (e.g., "10x" or "9")<br>
            - <strong>MV:</strong> Muzzle velocity for last shot (fps)<br>
            - <strong>Impact V:</strong> Impact velocity for last shot (fps)
          </div>
        </div>

        <div class="help-section">
          <h3>Scorecard</h3>
          <div class="param-help">
            - Click "Scorecard" button to view detailed match information<br>
            - Shows all match parameters (distance, target, wind, ballistics, rifle specs)<br>
            - Per-relay breakdown with sighters and two rows of 10 record shots<br>
            - Relay totals and overall match total<br>
            - Available anytime (shows parameters even before first shot)
          </div>
        </div>
        
        <div class="help-section">
          <h3>Technical Details</h3>
          <div class="param-help">
            <strong>Ballistics Engine:</strong><br>
            - WebAssembly-powered physics simulation (runs in browser)<br>
            - RK2 integration with 4DOF state<br>
            - Iterative zeroing in calm wind conditions<br>
            - Spin effects: drift zeroed, crosswind jump modeled as transient<br><br>

            <strong>Wind Simulation:</strong><br>
            - 2D curl-noise field with multiple octaves and advection<br>
            - RMS-normalized for consistent magnitude across presets<br>
            - Flags, mirage, and wind HUD sample same unified field<br>
            - Mirage emphasizes wind in final 25% of distance to aim point<br><br>

            <strong>Coordinates:</strong><br>
            - Three.js: X=right, Y=up, Z=towards camera (yards)<br>
            - Ballistics engine: X=downrange, Y=right, Z=up (meters)<br>
            - Automatic conversion between coordinate systems<br><br>

            <strong>Debug Mode:</strong><br>
            - Add <code>?debug=1</code> to URL for rapid testing mode<br>
            - 1-minute relays with 2 record shots<br>
            - Console logging for zeroing, shots, wind, and scoring
          </div>
        </div>
        
        <div class="help-section">
          <h3>Tips for Success</h3>
          <div class="param-help">
            - Start with calm wind conditions to learn the basics<br>
            - Use the spotting scope to observe flags, mirage, and shot impacts<br>
            - Compare mirage and flags at different distances for wind gradients<br>
            - Watch the red shot marker to see your last impact<br>
            - Make small adjustments to your aim point (0.1" increments)<br>
            - Pay attention to wind flag behavior along the entire range<br>
            - Higher BC bullets drift less in the wind<br>
            - Lower MV standard deviation = more consistent impacts<br>
            - Practice at shorter distances before attempting 1000 yards
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Scorecard Modal -->
  <div id="scorecardModal" class="scorecard-modal" style="display: none;">
    <div class="scorecard-content">
      <!-- Content will be dynamically generated by scorecard.js -->
    </div>
  </div>
</body>
</html>
